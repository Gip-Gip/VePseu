------- FILE main.asm LEVEL 1 PASS 2
      1  10000 ????						; VePseu's main file
      2  10000 ????
      3  10000 ????				       processor	6502
      4  10000 ????
------- FILE vepseu.h LEVEL 2 PASS 2
      0  10000 ????				       INCLUDE	"vepseu.h"
      1  10000 ????						; VePseu's header file
      2  10000 ????
      3  0000					      ORG	$0000
      4  0000
      5  0000		       00 00	   NULL       =	0
      6  0000
      7  0000		       00 00	   RSHIFT     =	0
      8  0000		       00 01	   LSHIFT     =	1
      9  0000
     10  0000		       00 07	   SHADCNT    =	7
     11  0000		       00 04	   PIXH       =	4
     12  0000		       00 05	   NWH	      =	5
     13  0000
     14  0000		       00 0e	   MCOLU      =	$0E
     15  0000		       00 06	   SCOLU      =	$06
     16  0000
     17  0000		       00 c2	   VBLANK_SET =	%11000010
     18  0000		       00 02	   VSYNC_SET  =	2
     19  0000
     20  0000		       00 01	   ONE	      =	1
     21  0000		       00 00	   INDEXINIT  =	0
     22  0000		       00 04	   WAITTIME   =	4
     23  0000
     24  0000		       00 10	   WALLCNT    =	16
     25  0000
     26  0000		       00 18	   UPPAD_LIMIT =	24
     27  0000
     28  0000		       00 80	   LAYER2_AND_0 =	%10000000
     29  0000		       00 f8	   LAYER2_AND_1 =	%11111000
     30  0000		       00 07	   LAYER2_AND_2 =	%00000111
     31  0000
     32  0000		       00 80	   LAYER3_AND_0 =	%10000000
     33  0000		       00 e0	   LAYER3_AND_1 =	%11100000
     34  0000		       00 1c	   LAYER3_AND_2 =	%00011100
     35  0000		       00 03	   LAYER3_AND_3 =	%00000011
     36  0000
     37  0000		       00 80	   SHAD_AND_0 =	%10000000
     38  0000		       00 c0	   SHAD_AND_1 =	%11000000
     39  0000		       00 e0	   SHAD_AND_2 =	%11100000
     40  0000		       00 f0	   SHAD_AND_3 =	%11110000
     41  0000		       00 f8	   SHAD_AND_4 =	%11111000
     42  0000
     43  0000		       00 00	   VSYNC      =	$00
     44  0000		       00 01	   VBLANK     =	$01
     45  0000		       00 02	   WSYNC      =	$02
     46  0000				   RSYNC
     47  0000				   NUSIZ0
     48  0000				   NUSIZ1
     49  0000				   COLUP0
     50  0000				   COLUP1
     51  0000		       00 08	   COLUPF     =	$08
     52  0000		       00 09	   COLUBK     =	$09
     53  0000				   CTRLPF
     54  0000				   REFP0
     55  0000				   REFP1
     56  0000		       00 0d	   PF0	      =	$0D
     57  0000		       00 0e	   PF1	      =	$0E
     58  0000		       00 0f	   PF2	      =	$0F
     59  0000				   RESP0
     60  0000				   RESP1
     61  0000				   RESM0
     62  0000				   RESM1
     63  0000				   RESBL
     64  0000				   AUDC0
     65  0000				   AUDC1
     66  0000				   AUDF0
     67  0000				   AUDF1
     68  0000				   AUDV0
     69  0000				   AUDV1
     70  0000				   GRP0
     71  0000				   GRP1
     72  0000				   ENAM0
     73  0000				   ENAM1
     74  0000				   ENABL
     75  0000				   HMP0
     76  0000				   HMP1
     77  0000				   HMM0
     78  0000				   HMM1
     79  0000				   HMBL
     80  0000				   VDELP0
     81  0000				   VDELP1
     82  0000				   VDELBL
     83  0000				   RESMP0
     84  0000				   RESMP1
     85  0000				   HMOVE
     86  0000				   HMCLR
     87  0000				   CXCLR
     88  0000
     89  0000		       00 00	   cleanStart =	0
     90  0000		       00 00	   cleanEnd   =	0
     91  0000
     92  0000							; Variables...
     93  0000
     94  0000		       00 80	   wall1a     =	$80
     95  0000		       00 81	   wall2a     =	$81
     96  0000		       00 82	   wall3a     =	$82
     97  0000		       00 83	   wall4a     =	$83
     98  0000		       00 84	   wall1b     =	$84
     99  0000		       00 85	   wall2b     =	$85
    100  0000		       00 86	   wall3b     =	$86
    101  0000		       00 87	   wall4b     =	$87
    102  0000		       00 88	   shadow1a   =	$88
    103  0000		       00 89	   shadow2a   =	$89
    104  0000		       00 8a	   shadow3a   =	$8A
    105  0000		       00 8b	   shadow4a   =	$8B
    106  0000		       00 8c	   shadow1b   =	$8C
    107  0000		       00 8d	   shadow2b   =	$8D
    108  0000		       00 8e	   shadow3b   =	$8E
    109  0000		       00 8f	   shadow4b   =	$8F
    110  0000
    111  0000		       00 90	   shift      =	$90
    112  0000		       00 91	   playerPos  =	$91
    113  0000		       00 92	   mapWidth   =	$92
    114  0000		       00 93	   xGain      =	$93
    115  0000		       00 94	   xLoss      =	$94
    116  0000		       00 95	   yGain      =	$95
    117  0000		       00 96	   yLoss      =	$96
    118  0000		       00 97	   mapPtr     =	$97
    119  0000
    120  0000		       00 ff	   stack      =	$FF
------- FILE main.asm
      6  0000
      7  0000					      SEG
      8  0000
      9  0000							;Initialize everything
     10  0000
     11  f000					      ORG	$F000
     12  f000
------- FILE map.asm LEVEL 2 PASS 2
      0  f000					      INCLUDE	"map.asm"
      1  f000							; VePseu's maps
      2  f000
      3  f000		       00 44	   MAP_01_POS =	$44
      4  f000		       00 10	   MAP_01_WDTH =	$10
      5  f000		       01 00	   MAP_01_SZ  =	$100
      6  f000
      7  f000				   mapList
      8  f000		       02 f0		      DC.W	map_01
      9  f002
     10  f002				   map_01
     11  f002							;	 0  1  2  3  4	5  6  7  8  9  A  B  C	D  E  F
     12  f002		       ff ff ff ff*	      HEX	FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF	; 0
     13  f012		       ff 00 00 00*	      HEX	FF 00 00 00 FF 00 00 00 00 00 00 00 00 00 00 FF	; 1
     14  f022		       ff 00 00 ff*	      HEX	FF 00 00 FF 00 FF 00 00 00 00 00 00 00 00 00 FF	; 2
     15  f032		       ff 00 00 ff*	      HEX	FF 00 00 FF 00 FF 00 00 00 00 00 00 00 00 00 FF	; 3
     16  f042		       ff 00 00 ff*	      HEX	FF 00 00 FF 00 FF 00 00 00 00 00 00 00 00 00 FF	; 4
     17  f052		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; 5
     18  f062		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; 6
     19  f072		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; 7
     20  f082		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; 8
     21  f092		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; 9
     22  f0a2		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; A
     23  f0b2		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; B
     24  f0c2		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; C
     25  f0d2		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; D
     26  f0e2		       ff 00 00 00*	      HEX	FF 00 00 00 00 00 00 00 00 00 00 00 00 00 00 FF	; E
     27  f0f2		       ff ff ff ff*	      HEX	FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF FF	; F
     28  f102
     29  f102				   map_01_load
     30  f102		       a9 44		      LDA	#MAP_01_POS
     31  f104		       85 91		      STA	playerPos
     32  f106		       a9 10		      LDA	#MAP_01_WDTH
     33  f108		       85 92		      STA	mapWidth
     34  f10a		       ad 00 f0 	      LDA	mapList
     35  f10d		       85 97		      STA	mapPtr
     36  f10f		       e8		      INX
     37  f110		       ad 01 f0 	      LDA	mapList + 1
     38  f113		       85 98		      STA	mapPtr + 1
     39  f115		       60		      RTS
------- FILE main.asm
     14  f116
     15  f800					      ORG	$F800
     16  f800
     17  f800				   clear		; Clear all wall values (199 cycles)
     18  f800		       a2 00		      LDX	#INDEXINIT
     19  f802		       a9 00		      LDA	#NULL
     20  f804
     21  f804				   _clear_loop
     22  f804
     23  f804		       95 80		      STA	wall1a,X
     24  f806		       e8		      INX
     25  f807		       e0 10		      CPX	#WALLCNT
     26  f809		       d0 f9		      BNE	_clear_loop
     27  f80b		       60		      RTS
     28  f80c
     29  f80c				   start
     30  f80c
------- FILE init.asm LEVEL 2 PASS 2
      0  f80c					      INCLUDE	"init.asm"
      1  f80c							; VePseu's init file
      2  f80c
      3  f80c		       a2 ff		      LDX	#stack
      4  f80e		       9a		      TXS
      5  f80f
      6  f80f		       a2 00		      LDX	#INDEXINIT
      7  f811		       a9 00		      LDA	#NULL
      8  f813
      9  f813		       d8		      CLD
     10  f814		       18		      CLC
     11  f815		       58		      CLI
     12  f816		       b8		      CLV
     13  f817
     14  f817				   cleanLoop
     15  f817
     16  f817		       95 00		      STA	cleanStart,X
     17  f819		       e8		      INX
     18  f81a
     19  f81a		       e0 00		      CPX	#cleanEnd
     20  f81c		       d0 f9		      BNE	cleanLoop
     21  f81e
     22  f81e		       20 02 f1 	      JSR	map_01_load
     23  f821
     24  f821		       a5 92		      LDA	mapWidth
     25  f823		       85 96		      STA	yLoss
     26  f825		       a9 01		      LDA	#ONE
     27  f827		       85 93		      STA	xGain
     28  f829		       a9 00		      LDA	#NULL
     29  f82b		       85 95		      STA	yGain
     30  f82d		       85 94		      STA	xLoss
------- FILE main.asm
     32  f82f
     33  f82f		       a9 02		      LDA	#VSYNC_SET
     34  f831
     35  f831				   screenStart
     36  f831
     37  f831							; Start vsync (3 scanlines)
     38  f831		       85 00		      STA	VSYNC
     39  f833
     40  f833		       85 02		      STA	WSYNC
     41  f835		       85 02		      STA	WSYNC
     42  f837		       a9 00		      LDA	#NULL
     43  f839		       85 02		      STA	WSYNC
     44  f83b
     45  f83b		       85 00		      STA	VSYNC
     46  f83d
     47  f83d							; Render everything (12 scanlines)
     48  f83d
------- FILE walrend.asm LEVEL 2 PASS 2
      0  f83d					      INCLUDE	"walrend.asm"	; 6 scanlines
      1  f83d							; VePseu's wall renderer
      2  f83d
      3  f83d					      MAC	y_pos_adv
      4  f83d
      5  f83d					      TYA
      6  f83d					      CLC
      7  f83d					      ADC	yGain
      8  f83d					      SEC
      9  f83d					      SBC	yLoss
     10  f83d					      TAY
     11  f83d
     12  f83d					      ENDM		; 14 cycles
     13  f83d
     14  f83d					      MAC	x_pos_gan
     15  f83d
     16  f83d					      TYA
     17  f83d					      CLC
     18  f83d					      ADC	xGain
     19  f83d					      SEC
     20  f83d					      SBC	xLoss
     21  f83d					      TAY
     22  f83d
     23  f83d					      ENDM		; 14 cycles
     24  f83d
     25  f83d					      MAC	x_pos_los
     26  f83d
     27  f83d					      TYA
     28  f83d					      CLC
     29  f83d					      ADC	xLoss
     30  f83d					      SEC
     31  f83d					      SBC	xGain
     32  f83d					      TAY
     33  f83d
     34  f83d					      ENDM		; 14 cycles
     35  f83d
     36  f83d		       a4 91		      LDY	playerPos	; 3 cycles
     37  f83f
------- FILE r_layers/layer1.asm LEVEL 3 PASS 2
      0  f83f					      INCLUDE	"r_layers/layer1.asm"	; 86 cycles
      1  f83f							; First layer of rendering (86 cycles)
      2  f83f
      0  f83f					      Y_POS_ADV		; 14 cycles
      1  f83f
      2  f83f		       98		      TYA
      3  f840		       18		      CLC
      4  f841		       65 95		      ADC	yGain
      5  f843		       38		      SEC
      6  f844		       e5 96		      SBC	yLoss
      7  f846		       a8		      TAY
      8  f847
      4  f847
      0  f847					      X_POS_GAN		; 23 cycles
      1  f847
      2  f847		       98		      TYA
      3  f848		       18		      CLC
      4  f849		       65 93		      ADC	xGain
      5  f84b		       38		      SEC
      6  f84c		       e5 94		      SBC	xLoss
      7  f84e		       a8		      TAY
      8  f84f
      6  f84f		       b1 97		      LDA	(mapPtr),Y
      7  f851		       85 8c		      STA	shadow1b
      8  f853
      0  f853					      X_POS_LOS		; 26 cycles
      1  f853
      2  f853		       98		      TYA
      3  f854		       18		      CLC
      4  f855		       65 94		      ADC	xLoss
      5  f857		       38		      SEC
      6  f858		       e5 93		      SBC	xGain
      7  f85a		       a8		      TAY
      8  f85b
     10  f85b		       b1 97		      LDA	(mapPtr),Y
     11  f85d		       85 80		      STA	wall1a
     12  f85f		       85 84		      STA	wall1b
     13  f861
      0  f861					      X_POS_LOS		; 23 cycles
      1  f861
      2  f861		       98		      TYA
      3  f862		       18		      CLC
      4  f863		       65 94		      ADC	xLoss
      5  f865		       38		      SEC
      6  f866		       e5 93		      SBC	xGain
      7  f868		       a8		      TAY
      8  f869
     15  f869		       b1 97		      LDA	(mapPtr),Y
     16  f86b		       85 88		      STA	shadow1a
------- FILE walrend.asm
     39  f86d
------- FILE r_layers/layer2.asm LEVEL 3 PASS 2
      0  f86d					      INCLUDE	"r_layers/layer2.asm"	; 148 cycles
      1  f86d							; Second Layer (148 cycles)
      2  f86d
      0  f86d					      Y_POS_ADV		; 14 cycles
      1  f86d
      2  f86d		       98		      TYA
      3  f86e		       18		      CLC
      4  f86f		       65 95		      ADC	yGain
      5  f871		       38		      SEC
      6  f872		       e5 96		      SBC	yLoss
      7  f874		       a8		      TAY
      8  f875
      4  f875
      0  f875					      X_POS_LOS		; 25 cycles
      1  f875
      2  f875		       98		      TYA
      3  f876		       18		      CLC
      4  f877		       65 94		      ADC	xLoss
      5  f879		       38		      SEC
      6  f87a		       e5 93		      SBC	xGain
      7  f87c		       a8		      TAY
      8  f87d
      6  f87d		       b1 97		      LDA	(mapPtr),Y
      7  f87f		       29 80		      AND	#LAYER2_AND_0
      8  f881		       85 89		      STA	shadow2a
      9  f883
      0  f883					      X_POS_GAN		; 25 cycles
      1  f883
      2  f883		       98		      TYA
      3  f884		       18		      CLC
      4  f885		       65 93		      ADC	xGain
      5  f887		       38		      SEC
      6  f888		       e5 94		      SBC	xLoss
      7  f88a		       a8		      TAY
      8  f88b
     11  f88b		       b1 97		      LDA	(mapPtr),Y
     12  f88d		       29 f8		      AND	#LAYER2_AND_1
     13  f88f		       85 81		      STA	wall2a
     14  f891
      0  f891					      X_POS_GAN		; 31 cycles
      1  f891
      2  f891		       98		      TYA
      3  f892		       18		      CLC
      4  f893		       65 93		      ADC	xGain
      5  f895		       38		      SEC
      6  f896		       e5 94		      SBC	xLoss
      7  f898		       a8		      TAY
      8  f899
     16  f899		       b1 97		      LDA	(mapPtr),Y
     17  f89b		       29 07		      AND	#LAYER2_AND_2
     18  f89d		       85 85		      STA	wall2b
     19  f89f		       05 81		      ORA	wall2a
     20  f8a1		       85 81		      STA	wall2a
     21  f8a3
      0  f8a3					      X_POS_GAN		; 28 cycles
      1  f8a3
      2  f8a3		       98		      TYA
      3  f8a4		       18		      CLC
      4  f8a5		       65 93		      ADC	xGain
      5  f8a7		       38		      SEC
      6  f8a8		       e5 94		      SBC	xLoss
      7  f8aa		       a8		      TAY
      8  f8ab
     23  f8ab		       b1 97		      LDA	(mapPtr),Y
     24  f8ad		       29 f8		      AND	#LAYER2_AND_1
     25  f8af		       05 85		      ORA	wall2b
     26  f8b1		       85 85		      STA	wall2b
     27  f8b3
      0  f8b3					      X_POS_GAN		; 25 cycles
      1  f8b3
      2  f8b3		       98		      TYA
      3  f8b4		       18		      CLC
      4  f8b5		       65 93		      ADC	xGain
      5  f8b7		       38		      SEC
      6  f8b8		       e5 94		      SBC	xLoss
      7  f8ba		       a8		      TAY
      8  f8bb
     29  f8bb		       b1 97		      LDA	(mapPtr),Y
     30  f8bd		       29 80		      AND	#LAYER2_AND_0
     31  f8bf		       85 8d		      STA	shadow2b
------- FILE walrend.asm
     41  f8c1
------- FILE r_layers/layer3.asm LEVEL 3 PASS 2
      0  f8c1					      INCLUDE	"r_layers/layer3.asm"	; 182 cycles
      1  f8c1							; Third layer (104 cycles)
      2  f8c1
      0  f8c1					      Y_POS_ADV		; 14 cycles
      1  f8c1
      2  f8c1		       98		      TYA
      3  f8c2		       18		      CLC
      4  f8c3		       65 95		      ADC	yGain
      5  f8c5		       38		      SEC
      6  f8c6		       e5 96		      SBC	yLoss
      7  f8c8		       a8		      TAY
      8  f8c9
      4  f8c9
      0  f8c9					      X_POS_GAN		; 25
      1  f8c9
      2  f8c9		       98		      TYA
      3  f8ca		       18		      CLC
      4  f8cb		       65 93		      ADC	xGain
      5  f8cd		       38		      SEC
      6  f8ce		       e5 94		      SBC	xLoss
      7  f8d0		       a8		      TAY
      8  f8d1
      6  f8d1		       b1 97		      LDA	(mapPtr),Y
      7  f8d3		       29 80		      AND	#LAYER3_AND_0
      8  f8d5		       85 8e		      STA	shadow3b
      9  f8d7
      0  f8d7					      X_POS_LOS		; 25
      1  f8d7
      2  f8d7		       98		      TYA
      3  f8d8		       18		      CLC
      4  f8d9		       65 94		      ADC	xLoss
      5  f8db		       38		      SEC
      6  f8dc		       e5 93		      SBC	xGain
      7  f8de		       a8		      TAY
      8  f8df
     11  f8df		       b1 97		      LDA	(mapPtr),Y
     12  f8e1		       29 e0		      AND	#LAYER3_AND_1
     13  f8e3		       85 86		      STA	wall3b
     14  f8e5
      0  f8e5					      X_POS_LOS		; 29
      1  f8e5
      2  f8e5		       98		      TYA
      3  f8e6		       18		      CLC
      4  f8e7		       65 94		      ADC	xLoss
      5  f8e9		       38		      SEC
      6  f8ea		       e5 93		      SBC	xGain
      7  f8ec		       a8		      TAY
      8  f8ed
     16  f8ed		       b1 97		      LDA	(mapPtr),Y
     17  f8ef		       29 1c		      AND	#LAYER3_AND_2
     18  f8f1		       05 86		      ORA	wall3b
     19  f8f3		       85 86		      STA	wall3b
     20  f8f5
      0  f8f5					      X_POS_LOS		; 31
      1  f8f5
      2  f8f5		       98		      TYA
      3  f8f6		       18		      CLC
      4  f8f7		       65 94		      ADC	xLoss
      5  f8f9		       38		      SEC
      6  f8fa		       e5 93		      SBC	xGain
      7  f8fc		       a8		      TAY
      8  f8fd
     22  f8fd		       b1 97		      LDA	(mapPtr),Y
     23  f8ff		       29 03		      AND	#LAYER3_AND_3
     24  f901		       85 82		      STA	wall3a
     25  f903		       05 86		      ORA	wall3b
     26  f905		       85 86		      STA	wall3b
     27  f907
      0  f907					      X_POS_LOS		; 29
      1  f907
      2  f907		       98		      TYA
      3  f908		       18		      CLC
      4  f909		       65 94		      ADC	xLoss
      5  f90b		       38		      SEC
      6  f90c		       e5 93		      SBC	xGain
      7  f90e		       a8		      TAY
      8  f90f
     29  f90f		       b1 97		      LDA	(mapPtr),Y
     30  f911		       29 1c		      AND	#LAYER3_AND_2
     31  f913		       05 82		      ORA	wall3a
     32  f915		       85 82		      STA	wall3a
     33  f917
      0  f917					      X_POS_LOS		; 29
      1  f917
      2  f917		       98		      TYA
      3  f918		       18		      CLC
      4  f919		       65 94		      ADC	xLoss
      5  f91b		       38		      SEC
      6  f91c		       e5 93		      SBC	xGain
      7  f91e		       a8		      TAY
      8  f91f
     35  f91f		       b1 97		      LDA	(mapPtr),Y
     36  f921		       29 e0		      AND	#LAYER3_AND_1
     37  f923		       05 82		      ORA	wall3a
     38  f925		       85 82		      STA	wall3a
     39  f927
      0  f927					      X_POS_LOS		; 25
      1  f927
      2  f927		       98		      TYA
      3  f928		       18		      CLC
      4  f929		       65 94		      ADC	xLoss
      5  f92b		       38		      SEC
      6  f92c		       e5 93		      SBC	xGain
      7  f92e		       a8		      TAY
      8  f92f
     41  f92f		       b1 97		      LDA	(mapPtr),Y
     42  f931		       29 80		      AND	#LAYER3_AND_0
     43  f933		       85 8a		      STA	shadow3a
------- FILE walrend.asm
     43  f935
     44  f935		       85 02		      STA	WSYNC	; By this time 2 scanlines have passed
------- FILE main.asm
     50  f937
------- FILE scrend.asm LEVEL 2 PASS 2
      0  f937					      INCLUDE	"scrend.asm"	; 6 Scanlines
      1  f937							; VePseu's screen renderer
      2  f937
      3  f937							; Remove the shadows incase only 1 wall is drawn (22 cycles)
      4  f937		       a5 88		      LDA	shadow1a
      5  f939		       05 80		      ORA	wall1a
      6  f93b		       45 80		      EOR	wall1a
      7  f93d		       29 f8		      AND	#%11111000
      8  f93f		       85 88		      STA	shadow1a
      9  f941
     10  f941		       a5 8c		      LDA	shadow1b
     11  f943		       05 84		      ORA	wall1b
     12  f945		       45 84		      EOR	wall1b
     13  f947		       29 f8		      AND	#%11111000
     14  f949		       85 8c		      STA	shadow1b
     15  f94b
     16  f94b
     17  f94b							; Merge walls (approx 381 cycles)
     18  f94b
     19  f94b		       a2 01		      LDX	#1
     20  f94d
     21  f94d				   mergeLoop
     22  f94d
     23  f94d							; Merge wall a
     24  f94d
     25  f94d		       b5 80		      LDA	wall1a,X	; 17 cycles
     26  f94f		       ca		      DEX
     27  f950		       15 80		      ORA	wall1a,X
     28  f952		       e8		      INX
     29  f953		       95 80		      STA	wall1a,X
     30  f955
     31  f955							; Make shadow a
     32  f955
     33  f955		       4a		      LSR		; 21 cycles
     34  f956		       ca		      DEX
     35  f957		       15 88		      ORA	shadow1a,X
     36  f959		       e8		      INX
     37  f95a		       15 88		      ORA	shadow1a,X
     38  f95c		       95 88		      STA	shadow1a,X
     39  f95e
     40  f95e							; Overlap wall a
     41  f95e
     42  f95e		       b5 80		      LDA	wall1a,X	; 22 cycles
     43  f960		       ca		      DEX
     44  f961		       15 88		      ORA	shadow1a,X
     45  f963		       55 88		      EOR	shadow1a,X
     46  f965		       e8		      INX
     47  f966		       95 80		      STA	wall1a,X
     48  f968
     49  f968							; Overlap shadow a
     50  f968
     51  f968		       b5 88		      LDA	shadow1a,X	; 20 cycles
     52  f96a		       15 80		      ORA	wall1a,X
     53  f96c		       55 80		      EOR	wall1a,X
     54  f96e		       95 88		      STA	shadow1a,X
     55  f970
     56  f970							; Merge wall b
     57  f970
     58  f970		       b5 84		      LDA	wall1b,X	; 17 cycles
     59  f972		       ca		      DEX
     60  f973		       15 84		      ORA	wall1b,X
     61  f975		       e8		      INX
     62  f976		       95 84		      STA	wall1b,X
     63  f978
     64  f978							; Make shadow b
     65  f978
     66  f978		       4a		      LSR		; 31 cycles
     67  f979		       ca		      DEX
     68  f97a		       15 8c		      ORA	shadow1b,X
     69  f97c		       e8		      INX
     70  f97d		       15 8c		      ORA	shadow1b,X
     71  f97f		       95 8c		      STA	shadow1b,X
     72  f981
     73  f981							; Overlap wall b
     74  f981
     75  f981		       b5 84		      LDA	wall1b,X	; 22 cycles
     76  f983		       ca		      DEX
     77  f984		       15 8c		      ORA	shadow1b,X
     78  f986		       55 8c		      EOR	shadow1b,X
     79  f988		       e8		      INX
     80  f989		       95 84		      STA	wall1b,X
     81  f98b
     82  f98b							; Overlap shadow b
     83  f98b
     84  f98b		       b5 8c		      LDA	shadow1b,X	; 20 cycles
     85  f98d		       15 84		      ORA	wall1b,X
     86  f98f		       55 84		      EOR	wall1b,X
     87  f991		       95 8c		      STA	shadow1b,X
     88  f993
     89  f993							; Loop if not done
     90  f993
     91  f993		       e8		      INX		; 7 or 6 cycles
     92  f994		       e0 04		      CPX	#4
     93  f996		       d0 b5		      BNE	mergeLoop
     94  f998
     95  f998		       85 02		      STA	WSYNC
     96  f99a
     97  f99a							; By this time, we know approx 6 scanlines have passed
------- FILE main.asm
     52  f99a
     53  f99a							; Pad!
     54  f99a
     55  f99a		       a2 00		      LDX	#INDEXINIT
     56  f99c
     57  f99c				   upperPad
     58  f99c		       85 02		      STA	WSYNC
     59  f99e
     60  f99e		       e8		      INX
     61  f99f		       e0 18		      CPX	#UPPAD_LIMIT
     62  f9a1		       d0 f9		      BNE	upperPad
     63  f9a3
     64  f9a3		       85 02		      STA	WSYNC
     65  f9a5
     66  f9a5							; Draw everything
     67  f9a5
------- FILE dispkern.asm LEVEL 2 PASS 2
      0  f9a5					      INCLUDE	"dispkern.asm"	; 121 Scanlines
      1  f9a5							; VePseu's display kernel
      2  f9a5
      3  f9a5							; This actually draws 136 lines to the screen instead of the usual 196. The
      4  f9a5							; only reason being it looks better with the small horizontal size of the
      5  f9a5							; picture
      6  f9a5
      7  f9a5		       4c ae f9 	      JMP	drawStart
      8  f9a8
      9  f9a8				   wait 		; Waits the right amount of time to blank the mirrored playfield
     10  f9a8		       ea		      NOP
     11  f9a9		       ea		      NOP
     12  f9aa		       ea		      NOP
     13  f9ab		       ea		      NOP
     14  f9ac		       60		      RTS
     15  f9ad
     16  f9ad				   wait2		; Waits the right amount of time to blank the mirrored playfield
     17  f9ad		       60		      RTS
     18  f9ae
     19  f9ae
     20  f9ae				   drawStart
     21  f9ae
     22  f9ae		       a0 80		      LDY	#SHAD_AND_0
     23  f9b0		       20 fc f9 	      JSR	otherWall
     24  f9b3		       a0 c0		      LDY	#SHAD_AND_1
     25  f9b5		       20 fc f9 	      JSR	otherWall
     26  f9b8		       a0 e0		      LDY	#SHAD_AND_2
     27  f9ba		       20 fc f9 	      JSR	otherWall
     28  f9bd		       a0 f0		      LDY	#SHAD_AND_3
     29  f9bf		       20 fc f9 	      JSR	otherWall
     30  f9c2		       a0 f8		      LDY	#SHAD_AND_4
     31  f9c4		       20 fc f9 	      JSR	otherWall
     32  f9c7		       a2 00		      LDX	#0
     33  f9c9		       20 3c fa 	      JSR	medWall
     34  f9cc		       a2 01		      LDX	#1
     35  f9ce		       20 3c fa 	      JSR	medWall
     36  f9d1		       a2 02		      LDX	#2
     37  f9d3		       20 3c fa 	      JSR	medWall
     38  f9d6		       a2 01		      LDX	#1
     39  f9d8		       20 3c fa 	      JSR	medWall
     40  f9db		       a2 00		      LDX	#0
     41  f9dd		       20 3c fa 	      JSR	medWall
     42  f9e0		       a0 f8		      LDY	#SHAD_AND_4
     43  f9e2		       20 fc f9 	      JSR	otherWall
     44  f9e5		       a0 f0		      LDY	#SHAD_AND_3
     45  f9e7		       20 fc f9 	      JSR	otherWall
     46  f9ea		       a0 e0		      LDY	#SHAD_AND_2
     47  f9ec		       20 fc f9 	      JSR	otherWall
     48  f9ef		       a0 c0		      LDY	#SHAD_AND_1
     49  f9f1		       20 fc f9 	      JSR	otherWall
     50  f9f4		       a0 80		      LDY	#SHAD_AND_0
     51  f9f6		       20 fc f9 	      JSR	otherWall
     52  f9f9
     53  f9f9		       4c 74 fa 	      JMP	stop
     54  f9fc
     55  f9fc				   otherWall
     56  f9fc
     57  f9fc		       a2 00		      LDX	#INDEXINIT
     58  f9fe
     59  f9fe				   _otherWall_loop
     60  f9fe
     61  f9fe		       85 02		      STA	WSYNC
     62  fa00
     63  fa00		       a9 0e		      LDA	#MCOLU
     64  fa02		       85 08		      STA	COLUPF
     65  fa04		       a5 80		      LDA	wall1a
     66  fa06		       85 0e		      STA	PF1
     67  fa08		       a5 84		      LDA	wall1b
     68  fa0a		       4a		      LSR
     69  fa0b		       85 0f		      STA	PF2
     70  fa0d
     71  fa0d		       20 a8 f9 	      JSR	wait
     72  fa10
     73  fa10		       a9 00		      LDA	#NULL
     74  fa12		       85 0e		      STA	PF1
     75  fa14		       85 0f		      STA	PF2
     76  fa16
     77  fa16		       85 02		      STA	WSYNC
     78  fa18
     79  fa18		       a9 06		      LDA	#SCOLU
     80  fa1a		       85 08		      STA	COLUPF
     81  fa1c		       84 90		      STY	shift
     82  fa1e		       a5 88		      LDA	shadow1a
     83  fa20		       25 90		      AND	shift
     84  fa22		       85 0e		      STA	PF1
     85  fa24		       85 0e		      STA	PF1
     86  fa26		       a5 8c		      LDA	shadow1b
     87  fa28		       25 90		      AND	shift
     88  fa2a		       4a		      LSR
     89  fa2b		       85 0f		      STA	PF2
     90  fa2d
     91  fa2d		       20 ad f9 	      JSR	wait2
     92  fa30
     93  fa30		       a9 00		      LDA	#NULL
     94  fa32		       85 0e		      STA	PF1
     95  fa34		       85 0f		      STA	PF2
     96  fa36
     97  fa36		       e8		      INX
     98  fa37		       e0 04		      CPX	#PIXH
     99  fa39		       d0 c3		      BNE	_otherWall_loop
    100  fa3b
    101  fa3b		       60		      RTS
    102  fa3c
    103  fa3c							; Every other wall drawing
    104  fa3c
    105  fa3c				   medWall
    106  fa3c
    107  fa3c		       a0 00		      LDY	#INDEXINIT
    108  fa3e
    109  fa3e				   _medWall_loop
    110  fa3e
    111  fa3e		       85 02		      STA	WSYNC
    112  fa40		       a9 0e		      LDA	#MCOLU
    113  fa42		       85 08		      STA	COLUPF
    114  fa44		       b5 81		      LDA	wall2a,X
    115  fa46		       85 0e		      STA	PF1
    116  fa48		       b5 85		      LDA	wall2b,X
    117  fa4a		       4a		      LSR
    118  fa4b		       85 0f		      STA	PF2
    119  fa4d
    120  fa4d		       20 a8 f9 	      JSR	wait
    121  fa50
    122  fa50		       a9 00		      LDA	#NULL
    123  fa52		       85 0e		      STA	PF1
    124  fa54		       85 0f		      STA	PF2
    125  fa56		       85 02		      STA	WSYNC
    126  fa58
    127  fa58		       a9 06		      LDA	#SCOLU
    128  fa5a		       85 08		      STA	COLUPF
    129  fa5c		       b5 89		      LDA	shadow2a,X
    130  fa5e		       85 0e		      STA	PF1
    131  fa60		       b5 8d		      LDA	shadow2b,X
    132  fa62		       4a		      LSR
    133  fa63		       85 0f		      STA	PF2
    134  fa65
    135  fa65		       20 a8 f9 	      JSR	wait
    136  fa68
    137  fa68		       a9 00		      LDA	#NULL
    138  fa6a		       85 0e		      STA	PF1
    139  fa6c		       85 0f		      STA	PF2
    140  fa6e
    141  fa6e		       c8		      INY
    142  fa6f
    143  fa6f		       c0 04		      CPY	#PIXH
    144  fa71		       d0 cb		      BNE	_medWall_loop
    145  fa73
    146  fa73		       60		      RTS
    147  fa74
    148  fa74				   stop
    149  fa74
    150  fa74		       85 02		      STA	WSYNC
    151  fa76
    152  fa76		       a9 00		      LDA	#NULL
    153  fa78		       85 0e		      STA	PF1
    154  fa7a		       85 0f		      STA	PF2
------- FILE main.asm
     69  fa7c
     70  fa7c							; Pad even more!
     71  fa7c
     72  fa7c		       a9 c2		      LDA	#VBLANK_SET
     73  fa7e		       85 01		      STA	VBLANK
     74  fa80
     75  fa80					      REPEAT	99
     76  fa80
     77  fa80		       85 02		      STA	WSYNC
     78  fa82
     75  fa82					      REPEND
     76  fa82
     77  fa82		       85 02		      STA	WSYNC
     78  fa84
     75  fa84					      REPEND
     76  fa84
     77  fa84		       85 02		      STA	WSYNC
     78  fa86
     75  fa86					      REPEND
     76  fa86
     77  fa86		       85 02		      STA	WSYNC
     78  fa88
     75  fa88					      REPEND
     76  fa88
     77  fa88		       85 02		      STA	WSYNC
     78  fa8a
     75  fa8a					      REPEND
     76  fa8a
     77  fa8a		       85 02		      STA	WSYNC
     78  fa8c
     75  fa8c					      REPEND
     76  fa8c
     77  fa8c		       85 02		      STA	WSYNC
     78  fa8e
     75  fa8e					      REPEND
     76  fa8e
     77  fa8e		       85 02		      STA	WSYNC
     78  fa90
     75  fa90					      REPEND
     76  fa90
     77  fa90		       85 02		      STA	WSYNC
     78  fa92
     75  fa92					      REPEND
     76  fa92
     77  fa92		       85 02		      STA	WSYNC
     78  fa94
     75  fa94					      REPEND
     76  fa94
     77  fa94		       85 02		      STA	WSYNC
     78  fa96
     75  fa96					      REPEND
     76  fa96
     77  fa96		       85 02		      STA	WSYNC
     78  fa98
     75  fa98					      REPEND
     76  fa98
     77  fa98		       85 02		      STA	WSYNC
     78  fa9a
     75  fa9a					      REPEND
     76  fa9a
     77  fa9a		       85 02		      STA	WSYNC
     78  fa9c
     75  fa9c					      REPEND
     76  fa9c
     77  fa9c		       85 02		      STA	WSYNC
     78  fa9e
     75  fa9e					      REPEND
     76  fa9e
     77  fa9e		       85 02		      STA	WSYNC
     78  faa0
     75  faa0					      REPEND
     76  faa0
     77  faa0		       85 02		      STA	WSYNC
     78  faa2
     75  faa2					      REPEND
     76  faa2
     77  faa2		       85 02		      STA	WSYNC
     78  faa4
     75  faa4					      REPEND
     76  faa4
     77  faa4		       85 02		      STA	WSYNC
     78  faa6
     75  faa6					      REPEND
     76  faa6
     77  faa6		       85 02		      STA	WSYNC
     78  faa8
     75  faa8					      REPEND
     76  faa8
     77  faa8		       85 02		      STA	WSYNC
     78  faaa
     75  faaa					      REPEND
     76  faaa
     77  faaa		       85 02		      STA	WSYNC
     78  faac
     75  faac					      REPEND
     76  faac
     77  faac		       85 02		      STA	WSYNC
     78  faae
     75  faae					      REPEND
     76  faae
     77  faae		       85 02		      STA	WSYNC
     78  fab0
     75  fab0					      REPEND
     76  fab0
     77  fab0		       85 02		      STA	WSYNC
     78  fab2
     75  fab2					      REPEND
     76  fab2
     77  fab2		       85 02		      STA	WSYNC
     78  fab4
     75  fab4					      REPEND
     76  fab4
     77  fab4		       85 02		      STA	WSYNC
     78  fab6
     75  fab6					      REPEND
     76  fab6
     77  fab6		       85 02		      STA	WSYNC
     78  fab8
     75  fab8					      REPEND
     76  fab8
     77  fab8		       85 02		      STA	WSYNC
     78  faba
     75  faba					      REPEND
     76  faba
     77  faba		       85 02		      STA	WSYNC
     78  fabc
     75  fabc					      REPEND
     76  fabc
     77  fabc		       85 02		      STA	WSYNC
     78  fabe
     75  fabe					      REPEND
     76  fabe
     77  fabe		       85 02		      STA	WSYNC
     78  fac0
     75  fac0					      REPEND
     76  fac0
     77  fac0		       85 02		      STA	WSYNC
     78  fac2
     75  fac2					      REPEND
     76  fac2
     77  fac2		       85 02		      STA	WSYNC
     78  fac4
     75  fac4					      REPEND
     76  fac4
     77  fac4		       85 02		      STA	WSYNC
     78  fac6
     75  fac6					      REPEND
     76  fac6
     77  fac6		       85 02		      STA	WSYNC
     78  fac8
     75  fac8					      REPEND
     76  fac8
     77  fac8		       85 02		      STA	WSYNC
     78  faca
     75  faca					      REPEND
     76  faca
     77  faca		       85 02		      STA	WSYNC
     78  facc
     75  facc					      REPEND
     76  facc
     77  facc		       85 02		      STA	WSYNC
     78  face
     75  face					      REPEND
     76  face
     77  face		       85 02		      STA	WSYNC
     78  fad0
     75  fad0					      REPEND
     76  fad0
     77  fad0		       85 02		      STA	WSYNC
     78  fad2
     75  fad2					      REPEND
     76  fad2
     77  fad2		       85 02		      STA	WSYNC
     78  fad4
     75  fad4					      REPEND
     76  fad4
     77  fad4		       85 02		      STA	WSYNC
     78  fad6
     75  fad6					      REPEND
     76  fad6
     77  fad6		       85 02		      STA	WSYNC
     78  fad8
     75  fad8					      REPEND
     76  fad8
     77  fad8		       85 02		      STA	WSYNC
     78  fada
     75  fada					      REPEND
     76  fada
     77  fada		       85 02		      STA	WSYNC
     78  fadc
     75  fadc					      REPEND
     76  fadc
     77  fadc		       85 02		      STA	WSYNC
     78  fade
     75  fade					      REPEND
     76  fade
     77  fade		       85 02		      STA	WSYNC
     78  fae0
     75  fae0					      REPEND
     76  fae0
     77  fae0		       85 02		      STA	WSYNC
     78  fae2
     75  fae2					      REPEND
     76  fae2
     77  fae2		       85 02		      STA	WSYNC
     78  fae4
     75  fae4					      REPEND
     76  fae4
     77  fae4		       85 02		      STA	WSYNC
     78  fae6
     75  fae6					      REPEND
     76  fae6
     77  fae6		       85 02		      STA	WSYNC
     78  fae8
     75  fae8					      REPEND
     76  fae8
     77  fae8		       85 02		      STA	WSYNC
     78  faea
     75  faea					      REPEND
     76  faea
     77  faea		       85 02		      STA	WSYNC
     78  faec
     75  faec					      REPEND
     76  faec
     77  faec		       85 02		      STA	WSYNC
     78  faee
     75  faee					      REPEND
     76  faee
     77  faee		       85 02		      STA	WSYNC
     78  faf0
     75  faf0					      REPEND
     76  faf0
     77  faf0		       85 02		      STA	WSYNC
     78  faf2
     75  faf2					      REPEND
     76  faf2
     77  faf2		       85 02		      STA	WSYNC
     78  faf4
     75  faf4					      REPEND
     76  faf4
     77  faf4		       85 02		      STA	WSYNC
     78  faf6
     75  faf6					      REPEND
     76  faf6
     77  faf6		       85 02		      STA	WSYNC
     78  faf8
     75  faf8					      REPEND
     76  faf8
     77  faf8		       85 02		      STA	WSYNC
     78  fafa
     75  fafa					      REPEND
     76  fafa
     77  fafa		       85 02		      STA	WSYNC
     78  fafc
     75  fafc					      REPEND
     76  fafc
     77  fafc		       85 02		      STA	WSYNC
     78  fafe
     75  fafe					      REPEND
     76  fafe
     77  fafe		       85 02		      STA	WSYNC
     78  fb00
     75  fb00					      REPEND
     76  fb00
     77  fb00		       85 02		      STA	WSYNC
     78  fb02
     75  fb02					      REPEND
     76  fb02
     77  fb02		       85 02		      STA	WSYNC
     78  fb04
     75  fb04					      REPEND
     76  fb04
     77  fb04		       85 02		      STA	WSYNC
     78  fb06
     75  fb06					      REPEND
     76  fb06
     77  fb06		       85 02		      STA	WSYNC
     78  fb08
     75  fb08					      REPEND
     76  fb08
     77  fb08		       85 02		      STA	WSYNC
     78  fb0a
     75  fb0a					      REPEND
     76  fb0a
     77  fb0a		       85 02		      STA	WSYNC
     78  fb0c
     75  fb0c					      REPEND
     76  fb0c
     77  fb0c		       85 02		      STA	WSYNC
     78  fb0e
     75  fb0e					      REPEND
     76  fb0e
     77  fb0e		       85 02		      STA	WSYNC
     78  fb10
     75  fb10					      REPEND
     76  fb10
     77  fb10		       85 02		      STA	WSYNC
     78  fb12
     75  fb12					      REPEND
     76  fb12
     77  fb12		       85 02		      STA	WSYNC
     78  fb14
     75  fb14					      REPEND
     76  fb14
     77  fb14		       85 02		      STA	WSYNC
     78  fb16
     75  fb16					      REPEND
     76  fb16
     77  fb16		       85 02		      STA	WSYNC
     78  fb18
     75  fb18					      REPEND
     76  fb18
     77  fb18		       85 02		      STA	WSYNC
     78  fb1a
     75  fb1a					      REPEND
     76  fb1a
     77  fb1a		       85 02		      STA	WSYNC
     78  fb1c
     75  fb1c					      REPEND
     76  fb1c
     77  fb1c		       85 02		      STA	WSYNC
     78  fb1e
     75  fb1e					      REPEND
     76  fb1e
     77  fb1e		       85 02		      STA	WSYNC
     78  fb20
     75  fb20					      REPEND
     76  fb20
     77  fb20		       85 02		      STA	WSYNC
     78  fb22
     75  fb22					      REPEND
     76  fb22
     77  fb22		       85 02		      STA	WSYNC
     78  fb24
     75  fb24					      REPEND
     76  fb24
     77  fb24		       85 02		      STA	WSYNC
     78  fb26
     75  fb26					      REPEND
     76  fb26
     77  fb26		       85 02		      STA	WSYNC
     78  fb28
     75  fb28					      REPEND
     76  fb28
     77  fb28		       85 02		      STA	WSYNC
     78  fb2a
     75  fb2a					      REPEND
     76  fb2a
     77  fb2a		       85 02		      STA	WSYNC
     78  fb2c
     75  fb2c					      REPEND
     76  fb2c
     77  fb2c		       85 02		      STA	WSYNC
     78  fb2e
     75  fb2e					      REPEND
     76  fb2e
     77  fb2e		       85 02		      STA	WSYNC
     78  fb30
     75  fb30					      REPEND
     76  fb30
     77  fb30		       85 02		      STA	WSYNC
     78  fb32
     75  fb32					      REPEND
     76  fb32
     77  fb32		       85 02		      STA	WSYNC
     78  fb34
     75  fb34					      REPEND
     76  fb34
     77  fb34		       85 02		      STA	WSYNC
     78  fb36
     75  fb36					      REPEND
     76  fb36
     77  fb36		       85 02		      STA	WSYNC
     78  fb38
     75  fb38					      REPEND
     76  fb38
     77  fb38		       85 02		      STA	WSYNC
     78  fb3a
     75  fb3a					      REPEND
     76  fb3a
     77  fb3a		       85 02		      STA	WSYNC
     78  fb3c
     75  fb3c					      REPEND
     76  fb3c
     77  fb3c		       85 02		      STA	WSYNC
     78  fb3e
     75  fb3e					      REPEND
     76  fb3e
     77  fb3e		       85 02		      STA	WSYNC
     78  fb40
     75  fb40					      REPEND
     76  fb40
     77  fb40		       85 02		      STA	WSYNC
     78  fb42
     75  fb42					      REPEND
     76  fb42
     77  fb42		       85 02		      STA	WSYNC
     78  fb44
     75  fb44					      REPEND
     76  fb44
     77  fb44		       85 02		      STA	WSYNC
     78  fb46
     79  fb46					      REPEND
     80  fb46
     81  fb46		       a9 00		      LDA	#NULL
     82  fb48		       85 01		      STA	VBLANK
     83  fb4a		       a9 02		      LDA	#VSYNC_SET
     84  fb4c		       85 02		      STA	WSYNC
     85  fb4e		       4c 31 f8 	      JMP	screenStart
     86  fb51
     87  fffa					      ORG	$FFFA
     88  fffa
     89  fffa
     90  fffa
     91  fffa		       0c f8		      .word.w	start	; NMI
     92  fffc
     93  fffc		       0c f8		      .word.w	start	; RESET
     94  fffe
     95  fffe		       31 f8		      .word.w	screenStart	; IRQ
     96  10000
     97  10000
     98  10000
     99  10000					       END
